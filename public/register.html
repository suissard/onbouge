<!DOCTYPE html>
<html lang="fr">
	<head>
		<meta charset="UTF-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0" />
		<title>Inscription - SportConnect</title>

		<!-- Font Awesome pour les icônes -->
		<link
			rel="stylesheet"
			href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css"
		/>
		<script src="js/main.js"></script>
		<script src="Core/StrapiApi.js"></script>
		<style>
			/* Reprise des variables et styles de base de votre CSS principal */
			:root {
				--header-bg: rgba(255, 255, 255, 0.9);
				--header-height: 4rem;
				--header-shadow: 0 1px 2px 0 rgba(0, 0, 0, 0.05);
				--text-color-dark: #1f2937;
				--text-color-medium: #4b5563;
				--text-color-light: #9ca3af;
				--brand-color: #4f46e5;
				--brand-color-hover: #4338ca;
				--hover-bg-light: #f3f4f6;
				--container-padding: 1rem;
				--body-bg: #f9fafb; /* Correspond à slate-50 */
				--card-bg: white;
				--card-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1),
					0 2px 4px -2px rgba(0, 0, 0, 0.1);
				--input-border: #d1d5db; /* Correspond à slate-300 */
				--success-color: #16a34a; /* green-600 */
				--error-color: #dc2626; /* red-600 */
			}

			body {
				display: flex;
				align-items: center;
				justify-content: center;
				min-height: 100vh;
				font-family: sans-serif;
				margin: 0;
				background-color: var(--body-bg);
			}

			/* Conteneur principal pour la carte d'inscription */
			.register-container {
				width: 100%;
				max-width: 420px;
				padding: 2rem;
			}

			/* La carte d'inscription */
			.register-card {
				background-color: var(--card-bg);
				padding: 2.5rem;
				border-radius: 0.75rem;
				box-shadow: var(--card-shadow);
			}

			.register-header {
				text-align: center;
				margin-bottom: 2rem;
			}

			.register-header h1 {
				font-size: 1.875rem;
				font-weight: 700;
				color: var(--text-color-dark);
				margin: 0;
			}

			.register-header p {
				margin-top: 0.5rem;
				color: var(--text-color-medium);
			}

			/* Style des champs du formulaire */
			.form-group {
				margin-bottom: 1.25rem;
			}

			.form-group label {
				display: block;
				font-weight: 500;
				color: var(--text-color-dark);
				margin-bottom: 0.5rem;
			}

			.form-group input {
				width: 100%;
				padding: 0.75rem 1rem;
				border: 1px solid var(--input-border);
				border-radius: 0.375rem;
				font-size: 1rem;
				box-sizing: border-box;
			}

			.form-group input:focus {
				outline: 2px solid transparent;
				outline-offset: 2px;
				border-color: var(--brand-color);
				box-shadow: 0 0 0 2px var(--brand-color);
			}

			/* Bouton de soumission */
			.submit-btn {
				width: 100%;
				padding: 0.75rem 1rem;
				border: none;
				border-radius: 0.375rem;
				background-color: var(--brand-color);
				color: white;
				font-size: 1rem;
				font-weight: 600;
				cursor: pointer;
				transition: background-color 0.2s;
				margin-top: 1rem;
			}

			.submit-btn:hover {
				background-color: var(--brand-color-hover);
			}

			/* Conteneur pour les messages d'erreur/succès */
			#message-container {
				margin-top: 1.5rem;
				padding: 1rem;
				border-radius: 0.375rem;
				text-align: center;
				font-weight: 500;
				display: none; /* Caché par défaut */
			}
			#message-container.success {
				background-color: #d1fae5; /* green-100 */
				color: var(--success-color);
				display: block;
			}
			#message-container.error {
				background-color: #fee2e2; /* red-100 */
				color: var(--error-color);
				display: block;
			}

			.login-link {
				text-align: center;
				margin-top: 1.5rem;
				font-size: 0.875rem;
				color: var(--text-color-medium);
			}

			.login-link a {
				color: var(--brand-color);
				font-weight: 500;
				text-decoration: none;
			}
			.login-link a:hover {
				text-decoration: underline;
			}
		</style>
	</head>
	<body>
		<main class="register-container">
			<div class="register-card">
				<div class="register-header">
					<h1>Créer un compte</h1>
					<p>Rejoignez la communauté SportConnect</p>
				</div>
				<form id="register-form">
					<div class="form-group">
						<label for="username">Nom d'utilisateur</label>
						<input type="text" id="username" name="username" required />
					</div>
					<div class="form-group">
						<label for="email">Adresse e-mail</label>
						<input type="email" id="email" name="email" required />
					</div>
					<div class="form-group">
						<label for="password">Mot de passe</label>
						<input type="password" id="password" name="password" required />
					</div>
					<div class="form-group">
						<label for="confirm-password">Confirmer le mot de passe</label>
						<input
							type="password"
							id="confirm-password"
							name="confirm-password"
							required
						/>
					</div>
					<button type="submit" class="submit-btn">S'inscrire</button>
				</form>
				<div id="message-container"></div>
				<div class="login-link">
					<p>Déjà un compte ? <a href="/login.html">Connectez-vous</a></p>
				</div>
			</div>
		</main>

		<script>
			// --- Logique du formulaire ---
			document.addEventListener("DOMContentLoaded", () => {
				const registerForm = document.getElementById("register-form");
				const messageContainer = document.getElementById("message-container");

				registerForm.addEventListener("submit", async (event) => {
					event.preventDefault();

					const username = event.target.username.value;
					const email = event.target.email.value;
					const password = event.target.password.value;
					const confirmPassword = event.target["confirm-password"].value;

					messageContainer.textContent = "";
					messageContainer.className = "";

					// Validation côté client
					if (password !== confirmPassword) {
						messageContainer.textContent = "Les mots de passe ne correspondent pas.";
						messageContainer.classList.add("error");
						return;
					}

					try {
						const userData = await api.register(username, email, password);

						messageContainer.textContent =
							"Inscription réussie ! Vous allez être redirigé...";
						messageContainer.classList.add("success");

						setTimeout(() => {
							window.location.href = "/";
						}, 2000);
					} catch (error) {
						messageContainer.textContent = error.message;
						messageContainer.classList.add("error");
					}
				});
			});
		</script>
	</body>
</html>
