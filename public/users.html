<!DOCTYPE html>
<html lang="fr">
	<head>
		<meta charset="UTF-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0" />
		<title>Contacts - SportConnect</title>

		<link rel="preconnect" href="https://fonts.googleapis.com" />
		<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
		<link
			href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap"
			rel="stylesheet"
		/>
		<script src="https://unpkg.com/lucide@latest"></script>
		<script src="js/main.js"></script>

		<link rel="stylesheet" href="style.css" />

		<style>
			.sport-tags {
				display: flex;
				flex-wrap: wrap;
				gap: 0.5rem;
				margin: 1rem 0;
			}
			.sport-tag {
				background-color: var(--cyan-100);
				color: var(--cyan-800);
				font-size: 0.8rem;
				font-weight: 500;
				padding: 0.25rem 0.6rem;
				border-radius: 9999px;
				text-transform: capitalize;
			}
			.privacy-status {
				display: flex;
				align-items: center;
				gap: 0.25rem;
				font-size: 0.85rem;
				color: var(--gray-500);
			}
		</style>
	</head>
	<body>
		<main>
			<div class="container">
				<div id="contacts-view" class="view active">
					<h2><i data-lucide="users" class="icon"></i>Participants à Proximité</h2>
					<div id="contacts-list" class="card-list"></div>
				</div>
			</div>
		</main>

		<script src="js/data.js"></script>

		<script>
			// Attend que le DOM soit chargé et les données récupérées
			document.addEventListener("DOMContentLoaded", async () => {
				// charge les données depuis les fichiers .json (via data.js)
				await loadData();
				// Affiche les contacts
				renderContacts();
			});

			/**
			 * Crée et affiche les cartes de contact dans la page
			 */
			function renderContacts() {
				const contactsList = document.getElementById("contacts-list");
				if (!contactsList) return;
				contactsList.innerHTML = ""; // Vide la liste existante

				// Boucle sur chaque utilisateur dans les données chargées
				db.users.forEach((user) => {
					const card = document.createElement("div");
					card.className = "card";

					// Génère les badges pour chaque sport pratiqué par l'utilisateur
					const sportsHtml = user.sport
						.map((sport) => `<span class="sport-tag">${sport.replace(".", " ")}</span>`)
						.join("");

					// Structure HTML de la carte de contact
					card.innerHTML = `
                    <div class="card-content">
                        <h3>
                            <i data-lucide="user" style="color: var(--blue-600);"></i> 
                            ${user.prenom} ${user.nom}
                        </h3>
                        <p>${user.description}</p>
                        
                        <div class="sport-tags">
                            ${sportsHtml}
                        </div>
                        
                        <p class="location">
                            <i data-lucide="map-pin" style="width:16px; height:16px;"></i> À proximité
                        </p>
                        
                        <footer>
                            <div class="privacy-status">
                                ${
																	user.privacy
																		? '<i data-lucide="eye-off" style="width:16px; height:16px;"></i><span>Profil privé</span>'
																		: '<i data-lucide="eye" style="width:16px; height:16px;"></i><span>Profil public</span>'
																}
                            </div>
                            <button class="btn-secondary">Contacter</button>
                        </footer>
                    </div>
                `;
					contactsList.appendChild(card);
				});

				// Met à jour les icônes après l'ajout des nouvelles cartes
				lucide.createIcons();
			}

			// Initialisation globale des icônes sur la page
			lucide.createIcons();
		</script>
	</body>
</html>
